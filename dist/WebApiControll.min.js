!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(o.printMsg=function(e,t){console.log(e,t)},o.getTimestamp=function(){return(new Date).getTime()},o.returnGender=function(e){switch(e){case"1":return"男";case"2":return"女";case"0":return"不适用"}},o.returnIdType=function(e){switch(e){case"1":return"居民身份证";case"2":return"护照";case"99":return"其它"}},o.returnTimeText=function(e,t){var n=e.getFullYear(),r=e.getMonth()+1,o=e.getDate(),i=e.getHours(),u=e.getMinutes();return e.getSeconds(),n+"年"+(10<=r?r:"0"+r)+"月"+(10<=o?o:"0"+o)+"日 "+[i,u].map(this.formatNumber).join(":")},o.returnTimeMinut=function(e){var t={s:"",m:"",h:""};return t.s=this.formatNumber(e%60),t.m=59<e?this.formatNumber(parseInt((e/60).toString())):"00",t},o.returnTimeDate=function(e){var t=new Date,n=t.getFullYear(),r=t.getMonth()+1,o=t.getDate();return n+e+(r<10?this.formatNumber(r):r)+e+(o<10?this.formatNumber(o):o)},o.formatNumber=function(e){var t=e.toString();return t[1]?t:"0"+t},o.stringUpper=function(e,t){return""!=e.trim()?0<t?(e=e.toLowerCase()).replace(e[0],e[0].toUpperCase()):e.toUpperCase():""},o.stringLower=function(e,t){return""!=e.trim()?0<t?e.replace(e[0],e[0].toLowerCase()):e.toLowerCase():""},o.returnHmacStr=function(e,t,n){return"sha1"==e?CryptoJS.HmacSHA1(t,n).toString():"MD5"==e?Crypto.MD5(t,n):void 0},o.getQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=new RegExp("(^|/)"+e+"/([^/]*)(/|$)","i"),r=window.location.search.substr(1).match(t),o=window.location.pathname.substr(1).match(n);return null!=r?unescape(r[2]):null!=o?unescape(o[2]):null},o.outPutArray=function(e){},o.getFileExtendingName=function(e){var t=/\.[^\.]+$/.exec(e);return t?t[0]:""},o);function o(){}t.Util=r},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=n(2),i=n(0),u=(function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(a,[{key:"getStemp",value:function(){return Date.parse((new Date).toString())/1e3}},{key:"uploadImg",value:function(e,t,n){var r=this;return new Promise(function(e,n){r.netRequest.requestData("GET","/file-auth",t).then(function(e){}).catch(function(e){n(e)})})}},{key:"fetchError",value:function(e){console.log("fetch error: "+e)}},{key:"uploadImgToAli",value:function(e,t){var n=this,r=i.Util.returnHmacStr("MD5",{n:"11",r:n.getStemp()});return new Promise(function(o,i){n.sparkMd5Img(e,function(e){var n=r+"_"+e+".jpg";o({fkey:r=t+n,fname:n})},function(e){i(e)})})}},{key:"getFileByBase",value:function(e){var t=this,n=i.Util.returnHmacStr("MD5",{n:"11",r:this.getStemp()});return new Promise(function(r,o){t.urltoFile(e,n+".jpg").then(function(e){r(e)}).catch(function(e){o(e)})})}},{key:"urltoFile",value:function(e,t){var n=(e.match(/^data:([^;]+);/)||"")[1];return fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){return new File([e],t,{type:n})})}},{key:"requestUploadAli",value:function(e,t,n){return new Promise(function(r,o){new OSS(n).put(t.fkey,e).then(function(e){r(e)}).catch(function(e){o(e)})})}},{key:"sparkMd5Img",value:function(e,t,n){var r=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,o=2097152,i=Math.ceil(e.size/o),u=0,a=new SparkMD5.ArrayBuffer,c=new FileReader;function s(){var t=u*o,n=t+o>=e.size?e.size:t+o;c.readAsArrayBuffer(r.call(e,t,n))}c.onload=function(e){if(console.log("read chunk nr",u+1,"of",i),a.append(e.target.result),++u<i)s();else{var n=a.end(!1);console.info("finished computed hash",n),"function"==typeof t&&t(n)}},c.onerror=function(){"function"==typeof n&&n("oops, something went wrong.")},s()}}]),a);function a(e){!function(e,t){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this),this.util=i.Util,this.netRequest=new o.NetRequest(e.u,e.k,e.d)}window.WebApiControll=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=(i.prototype.requestData=function(e,t,n){var o=this;this.debug&&r.Util.printMsg("request "+t+": "+JSON.stringify(n),"");var i=this.yUrl+t,u={};if("GET"===e){var a=this.formatDataParams(n);u={method:e,headers:new Headers({Connection:"keep-alive","Content-Type":"application/json; charset=utf-8"})},n.s=r.Util.returnHmacStr("MD5",a),i=this.formatData(i,n)}else"POST"===e&&(a=this.formatDataParams(n),n.s=r.Util.returnHmacStr("MD5",a),u={method:e,body:JSON.stringify(n),headers:new Headers({Connection:"keep-alive","Content-Type":"application/json; charset=utf-8"})});return new Promise(function(e,n){if(navigator.onLine){var a=0,c=setTimeout(function(){0===a&&(a=2,clearTimeout(c),c=null,n("10001"))},3e4);fetch(i,u).then(function(e){return e.json()}).then(function(n){2!==a&&(clearTimeout(c),c=null,a=1,o.debug&&r.Util.printMsg("result "+t+": ",n),e(n))}).catch(function(e){clearTimeout(c),c=null,a=1,n(e)})}else n("10001")})},i.prototype.formatData=function(e,t){var n=[];return Object.keys(t).forEach(function(e){return n.push(e+"="+t[e])}),0==n.length||(-1===e.search(/\?/)?e+="?"+n.join("&"):e+="&"+n.join("&")),e},i.prototype.formatDataParams=function(e){var t=[];return Object.keys(e).forEach(function(n){return t.push(n+"="+e[n])}),(t=t.sort()).join("&")},i);function i(e,t,n){this.yUrl=e,this.yKey=t,this.debug=n}t.NetRequest=o}]);